<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Finder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: white;
            color: black;
            text-align: center;
        }

        #input-container {
            width: 100%;
            height: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #output-container {
            width: 100%;
            height: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            color: black;
        }

        hr {
            width: 100%;
            border: 1px solid gray;
        }

        input {
            width: 60%;
            padding: 15px;
            font-size: 24px;
            text-align: center;
            border: 1px solid gray;
            background-color: white;
            color: black;
            border-radius: 5px;
            outline: none;
        }
    </style>
</head>
<body>

    <div id="input-container">
        <input type="text" id="wordInput" placeholder="Waiting for input..." autofocus>
    </div>

    <hr>

    <div id="output-container">No words yet...</div>

    <script>
        const BASE_URL = "https://fly.wordfinderapi.com/api/search";
        const CORS_PROXY = "https://api.cors.lol/?url=";
        const outputContainer = document.getElementById("output-container");
        const wordInput = document.getElementById("wordInput");

        async function fetchWords(word) {
            if (!word) {
                outputContainer.innerHTML = "No words found";
                return;
            }

            const params = new URLSearchParams({
                contains: word,
                length: 5,
                word_sorting: "points",
                group_by_length: "true",
                page_size: 20,
                dictionary: "wwf2",
            });

            const url = CORS_PROXY + encodeURIComponent(`${BASE_URL}?${params}`);

            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error("API Error");

                const data = await response.json();
                const wordPages = data.word_pages || [];
                const wordList = wordPages.length > 0 ? wordPages[0].word_list : [];

                if (!wordList.length) {
                    outputContainer.innerHTML = "No words found";
                    return;
                }

                const words = wordList.slice(0, 5).map(w => w.word).join(", ");
                outputContainer.innerHTML = words;

            } catch (error) {
                outputContainer.innerHTML = "Error fetching words";
                console.error(error);
            }
        }

        wordInput.addEventListener("input", (e) => {
            fetchWords(e.target.value.trim());
        });

        async function checkClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                const words = text.replace(/\*/g, "").trim().split(/\s+/);
                const lastWord = words[words.length - 1];

                if (lastWord !== wordInput.value) {
                    wordInput.value = lastWord;
                    fetchWords(lastWord);
                }
            } catch (error) {
                console.warn("Clipboard access denied:", error);
            }
        }

        setInterval(checkClipboard, 2000);

    </script>

</body>
</html>
